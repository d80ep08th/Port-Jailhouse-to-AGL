<!DOCTYPE html>
<html>
<head>

<meta charset=“UTF-8”>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Port Jailhouse to agl </title>


<link rel="stylesheet" href="reset.css" type="text/css" />
<link rel="stylesheet" href="styles.css" type="text/css" />
<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">


<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/slider.js"></script>
<script type="text/javascript" src="js/superfish.js"></script>

<script type="text/javascript" src="/js/custom.js"></script>

<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />

<!--
deiform, a free CSS web template by ZyPOP (zypopwebtemplates.com/)

Download: http://zypopwebtemplates.com/

License: Creative Commons Attribution
//-->
</head>



<body>
<div id="container" class="width">

    <header>
	<div class="width">

    		<h1><a href="https://github.com/d80ep08th/Port-Jailhouse-to-AGL">Port Jailhouse to AGL</a></h1>
<!--
		<nav>

    			<ul class="sf-menu dropdown">


        			<li class="selected"><a href="index.html">Home</a></li>

            			<li>

					<a href="examples.html">Style examples</a>

					<ul>
                				<li><a href="three-column.html">Three Column</a></li>
						<li><a href="one-column.html">One Column</a></li>
                    				<li><a href="#">Another link</a></li>
                			</ul>

            			</li>

	     			<li><a href="#">Services</a></li>

				<li>

					<a href="#">Products</a>

					<ul>
                				<li><a href="#">Product One</a></li>
                   				<li><a href="#">Product Two</a></li>
                   				<li><a href="#">Product Three</a></li>
                			</ul>

            			</li>

				<li><a href="#">Contact</a></li>
       			</ul>


			<div class="clear"></div>
    		</nav>
			-->
       	</div>

	<div class="clear"></div>


    </header>


    <div id="intro">

	<div class="width">

		<div class="intro-content">

                    <h2>If we use AGL as the main OS to install a hypervisor on an AGL reference platform. We can then partition the CPU using that hypervisor. This hypervisor will give the RTOS a virtual operating platform. This is where the Jailhouse hypervisor becomes a core part of the project.The RTOS running as guest on the hypervisor can then procure data in real time and communicate it with the AGL OS.</h2>




            	</div>

            </div>


	</div>

    <div id="body" class="width">



		<section id="content" class="two-column with-right-sidebar">

	    <article>


			<h2>Building Jailhouse image for Raspi 4</h2>
			<div class="article-info">Posted on <time datetime="2020-06-7">7 June</time> by <a href="#" rel="author">Parth Dode [GSOC'20 week 1]</a></div>

            <p>

Clone the Jailhouse-images repository which contains the script that will build you the image for your device -

$ git clone https://github.com/siemens/jailhouse-images.git

Permit the build-images.sh file to be executed

$ chmod +x build-images.sh

Call the script

$ ./build-images.sh

Available images demo images:
 1: QEMU/KVM Intel-x86 virtual target
 2: QEMU ARM64 virtual target
 3: Orange Pi Zero (256 MB edition)
 4: Intel NUC (NUC6CAY, 8 GB RAM)
 5: Marvell ESPRESSObin (1 GB edition)
 6: Marvell MACCHIATObin
 7: LeMaker HiKey (Kirin 620 SoC, 2 GB edition)
 8: Avnet Ultra96
 9: Raspberry Pi 4 (1 GB edition)
 10: Pine64+ (Allwinner A64, 2GB edition)
 0: all (may take hours...)

Select images to build (space-separated index list):

You’ll get the above output to which you will have to input the no. next to the device for which you want to build the image ( which in this case is  9 ) - This will start the build process.




If you are running this script as root , then you may face error at some point during the build process .
Reason being , If the kas build container is started as root, the host-tar configure step in buildroot will bail out. Beside accidental manual invocation as root, some CI setup may generate such a scenario. Avoid that failure by setting the env variable that the configure step suggests.
Change directory to  /recipes-core/non-root-initramfs/files/debian
In debian folder there is a file named -  rules
Add the following to the rules file : -

export FORCE_UNSAFE_CONFIGURE=1

 override_dh_auto_configure:
        cp ../.config .
        ${MAKE} olddefconfig



Your image should build smoothly but give it like a half an hr to be done.
You will get the image file here ->
 build/tmp/deploy/images/rpi4/demo-image-jailhouse-demo-rpi4.wic.img

 Flash this image on an empty sd card  to make a bootable sd-card so you can load it

You need to find the location and name of the microsd card as read by your computer. To list info of all block devices run this -
$  lsblk

Your usb will be listed under sdb
For example -
sdb      8:16   1  14.9G  0 disk
├─sdb1   8:17   1  60.9M  0 part /media/root/boot
└─sdb2   8:18   1   5.7G  0 part /media/root/root

Unmount the blocks under sdb
		$ sudo umount dev/sdb/<?>

Use dd to flash the img to sd card
$ dd if=<location of image> of=<usb location> bs=4M  status=progress && sync

where ,
 if =  build/tmp/deploy/images/rpi4/demo-image-jailhouse-demo-rpi4.wic.img
and,
of = dev/sdb

Insert the bootable microsd card in your raspi4 and power it up.
The display will open up a console on which you can now run jailhouse.
</p>






		</article>


        </section>

<!--        <aside class="sidebar big-sidebar right-sidebar">


</aside>  -->
    	<div class="clear"></div>
    </div>
</div>

    <footer>

    </footer>
</body>







</html>
